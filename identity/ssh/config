# q1sh101 - ssh client config

# --- authentication ---
# keys only - no password brute-force
PubkeyAuthentication yes
# never send password over network
PasswordAuthentication no
KbdInteractiveAuthentication no
GSSAPIAuthentication no
# only send keys we explicitly configure
IdentitiesOnly yes
# never auto-cache keys in agent
AddKeysToAgent no

# --- host verification ---
# always verify new hosts - no blind trust
StrictHostKeyChecking ask
# detect DNS spoofing
CheckHostIP yes
# hash known_hosts - no recon if stolen
HashKnownHosts yes
# show fingerprint art - spot changes
VisualHostKey yes
# accept server key rotations automatically
UpdateHostKeys yes

# --- disable forwarding ---
# agent hijack if server compromised
ForwardAgent no
# X11 is not secure
ForwardX11 no
ForwardX11Trusted no
# no lateral movement on compromise
HostbasedAuthentication no
Tunnel no
PermitLocalCommand no

# --- cryptography algorithms ---
# post-quantum first (mlkem768 = NIST ML-KEM, sntrup761 = IANA + legacy name)
KexAlgorithms mlkem768x25519-sha256,sntrup761x25519-sha512,sntrup761x25519-sha512@openssh.com,curve25519-sha256,curve25519-sha256@libssh.org,diffie-hellman-group18-sha512,diffie-hellman-group16-sha512
Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes256-ctr
MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,umac-128-etm@openssh.com
HostKeyAlgorithms ssh-ed25519,rsa-sha2-512,rsa-sha2-256
PubkeyAcceptedAlgorithms ssh-ed25519,rsa-sha2-512,rsa-sha2-256
# reject RSA keys smaller than 3072 bits
RequiredRSASize 3072

# --- session ---
# detect dead connections - 60 sec ping
ServerAliveInterval 60
# 10 failures = disconnect (10 min max)
ServerAliveCountMax 10
# rotate session key every 1GB or 1 hour
RekeyLimit 1G 1h
